---
node_id: 3636
title: PCI Compliance in Rackspace Hybrid Cloud
type: whitepaper
created_date: '2013-08-06'
created_by: Rackspace Support
last_modified_date: '2015-07-21'
last_modified_by: Max Francisco
product: White Paper
product_url: white-paper
resource: 'https://8026b2e3760e2433679c-fffceaebb8c6ee053c935e8915a3fbe7.ssl.cf2.rackcdn.com/whitepaper_pdf/PCI_Compliance_Rackspace_Hybrid_Cloud.pdf'
---

<p>Authors:<br />
Mahesh Gande, Senior Solutions Manager<br />
Francis Ofungwu, Product Manager for Rackspace Security Solutions<br />
Jarret Raim, Rackspace Cloud Security Product Manager<br />
Lizetta Staplefoote, Online Content Strategist</p>

<h3>Introduction</h3>

<p>Meeting Payment Card Industry â€“ Data Security Standards (PCI-DSS) can be a complex and costly exercise for the average e-commerce merchant. This may explain why 96% of 2011 breach victims were not compliant as of their last assessment or had never been validated<sup>1</sup>.</p>

<p>There is no one-size-fits-all approach to achieving and maintaining compliance. Merchants without the expertise to execute an effective compliance program should seek guidance from external partners to supplement their knowledge gaps and infrastructure deficiencies.</p>

<h3>The 12 Requirements of PCI-DSS Compliance</h3>

<p>PCI-DSS is a set of comprehensive requirements for enhancing payment account data security. The standard was developed by the PCI Security Standards Council, which includes American Express, Discover Financial Services, JCB International, MasterCard Worldwide and Visa to help facilitate the broad adoption of consistent data security measures on a global basis.<br />
<em>82% of breached operations weren't compliant with PCI-DSS standards for protection of stored data<sup>2</sup>.</em></p>

<p>PCI compliance is broken down into 12 steps across six categories of protection:</p>

<ol>
  <li>Build and Maintain a Secure Network
    <ul>
      <li><strong>Requirement 1</strong>: Install and maintain a firewall configuration to protect cardholder data.
        <p>Establishes firewall and router configuration standards that mandate testing, testing procedures, and a review of configuration rule sets every six months.</p></li>
      <li><strong>Requirement 2</strong>: Do not use vendor-supplied defaults for system passwords and other security parameters.
        <p>Addresses password hygiene with respect to vendor-supplied passwords that if combined with hacker tools able to show all of your networked devices can make you a sitting duck for unauthorized entry.</p></li>
      </ul>
    </li>
  <li>Protect Cardholder Data
      <ul>
        <li><strong>Requirement 3</strong>: Protect stored cardholder data.
          <p>Defines storage, encryption, and retention of cardholder data and authentication data for required business uses. Also covers the documentation and protection of the keys used to encrypt cardholder data.</p>
          <p><img height="211" align="center" src="https://8026b2e3760e2433679c-fffceaebb8c6ee053c935e8915a3fbe7.ssl.cf2.rackcdn.com/new1.png" width="434" /></p></li>
        <li><strong>Requirement 4</strong>: Encrypt transmission of cardholder data across open, public networks
          <p>Refers to the implementation of strong cryptography and security protocols such as SSL/TLS, SSH or IPSec to safeguard sensitive cardholder data during transmission over open, public networks (Internet and mobile). Additionally, wireless networks transmitting cardholder data or connected to the cardholder data environment must use industry best practices to implement strong encryption for authentication and transmission.</p></li>
        </ul>
      </li>
    <li>Maintain a Vulnerability Management Program
      <ul>
        <li><strong>Requirement 5</strong>: Use and regularly update anti-virus software or programs
          <p>Any system potentially affected by malware must be protected by anti-virus software that is current, actively running, and generating audit logs.</p></li>
        <li><strong>Requirement 6</strong>: Develop and maintain secure systems and applications
          <p>Application code must adhere to secure coding guidelines including reviewing custom application and third-party code to identify vulnerabilities.</p></li>
        </ul>
      </li>
    <li>Implement Strong Access Control Measures
      <ul>
        <li><strong>Requirement 7</strong>: Limit access to system component and cardholder data to only those individuals whose job requires such access
          <p>To protect critical data from access by unauthorized personnel inside and outside of the business, systems and documented processes must exist to restrict access to cardholder data using role-based access controls (RBAC) set to "deny all" unless access to cardholder data and systems is specifically granted.</p></li>
        <li><strong>Requirement 8</strong>: Assign a unique ID
          <p>Any user granted access to cardholder data must have a unique identification so that actions taken on critical data and systems are performed by, and can be traced to, known and authorized users. This requirement also includes provisions around using two-factor authentication via token and storage of user passwords.</p></li>
        <li><strong>Requirement 9</strong>: Restrict physical access to cardholder data
          <p>To safeguard against physical media containing cardholder data being removed or compromised, areas where devices, data, systems, or hardcopies of cardholder data must be restricted from general access. This applies to both electronic systems for all online merchants and paper receipts and POS systems for brick and mortal establishments.</p></li>
        </ul>
      </li>
    <li>Regularly Monitor and Test Network
      <ul>
        <li><strong>Requirement 10</strong>: Track and monitor all access to network resources and cardholder data
          <p>Logging mechanisms and the ability to track user activities are critical for effective forensics and vulnerability management. Logs should record specific actions and create an audit trail including, at a minimum: user identification, type of event, date and time, success or failure indication, origination of event, and identity or name of affected data, system component or resource. These logs should be reviewed daily and audit trails retained for at least a year.</p></li>
        <li><strong>Requirement 11</strong>: Regularly test security systems and processes
          <p>Run internal and external network vulnerability scans at least quarterly and after any significant change in the network or infrastructure, application upgrade or modification. After passing the initial compliance scan, merchants must pass four more consecutive quarterly scans by an Approved Scanning Vendor (ASV) as a requirement for compliance. This provision also includes the use of up-to-date network intrusion detection systems (IDS) and file integrity monitoring tools to check for and alert to system compromise or unauthorized modification of critical files.</p>
          <p><em>Only 6% of breached organizations report having regular security systems testing and processes<sup>3</sup>.</em></p></li>
        </ul>
      </li>
    <li>Maintain an Information Security Policy
      <ul>
        <li><strong>Requirement 12</strong>: Maintain a policy that addresses information security for all personnel
          <p>Establish, publish, update, and disseminate a security policy that addresses compliance requirements. This policy should include an annual review process for identifying vulnerabilities and formally assessing risks. Defined usage policies for employee screening, remote access, wireless, removable electronic media, laptops, tablets, handheld devices, email and internet are also required.</p></li>
        </ul>
      </li>
  </ol>

<h3>Who Needs PCI-DSS Compliance?</h3>

<p>If your business meets either of these criteria, you should have a PCI-DSS strategy in place:</p>

<ul>
  <li>Do you store, process, or transmit Cardholder data?<sup>*</sup></li>
  <li>Do you provide services to merchants who process, store, or transmit Cardholder data?<sup>*</sup></li>
</ul>

<p><sup>*</sup>Refers to PAN (Primary Account Number) plus cardholder name, expiration date, service code.</p>

<h4>Understanding PCI-DSS Merchant Levels And Validation Types</h4>

<p>The process and frequency of validating compliance with these 12 steps is determined by your merchant level and security assessment types below:</p>

<p><img height="195" align="center" src="https://8026b2e3760e2433679c-fffceaebb8c6ee053c935e8915a3fbe7.ssl.cf2.rackcdn.com/pci2a.png" width="499" /></p>

<p>Your validation type determines which SAQ you need to complete.</p>

<p><img height="220" align="center" src="https://8026b2e3760e2433679c-fffceaebb8c6ee053c935e8915a3fbe7.ssl.cf2.rackcdn.com/pci3a.png" width="502" /><br />
  <em><sup>*</sup>This is an example of VISA card brand classifications. Other industry standards exist.</em></p>

<h4>Why is Compliance Important?</h4>

<p>Non-compliance to PCI-DSS could lead to:</p>

<ul>
  <li>Loss of reputation</li>
  <li>Increased costs for accepting credit card transactions</li>
  <li>Substantial fines associated with security breaches and non-compliance</li>
</ul>

<p>Should a breach occur as a result of non-compliance, there are discovery and containment costs for investigating the incident, remediation expenses, and attorney and legal fees in addition to:</p>

<ul>
  <li>Loss of customer confidence</li>
  <li>Lost sales and revenue</li>
  <li>Brand degradation or drop in public stock value</li>
  <li>Fines and penalties for non-compliance with PCI-DSS</li>
  <li>Termination of the ability to accept payment cards</li>
  <li>Fraud losses</li>
  <li>Cost of reissuing new payment cards</li>
  <li>Dispute resolution costs</li>
  <li>Cost of legal settlements or judgments</li>
</ul>

<p><img height="369" align="center" src="https://8026b2e3760e2433679c-fffceaebb8c6ee053c935e8915a3fbe7.ssl.cf2.rackcdn.com/pci4a.png" width="551" /></p>

<h4>Partnering for PCI-DSS Compliance</h4>

<p>Because of the complexity and necessity of maintaining PCI-DSS, many merchants opt to enlist solutions partners to provide the tools needed to build compliant infrastructure elements.</p>

<p>Even with partners involved, PCI-DSS compliance is a dual responsibility shared by you and your provider. Hosting with a provider that offers PCI-DSS compliant infrastructure doesn't automatically make you compliant. For example, a simple coding mistake can still leave a business open to an exploit even with strong hosting and security partners. As you can see below, each entity bears responsibility:</p>

<p><img height="276" align="center" src="https://8026b2e3760e2433679c-fffceaebb8c6ee053c935e8915a3fbe7.ssl.cf2.rackcdn.com/PCI23.png" width="502" /></p>

<h3>Achieving PCI-DSS Compliance</h3>

<p><strong>Questions to ask:</strong></p>

<ol>
  <li>Has your bank contacted you about PCI-DSS or stipulated a date when they require compliance?
    <p><em>Why this is important: May determine how aggressive your compliance timeline needs to be.</em></p></li>
  <li>Have you contacted your Acquirer about PCI-DSS compliance?
    <p><em>Why this is important: The Acquirer is typically responsible for merchant compliance.</em></p></li>
  <li>What payment brand compliance program (AMeX, Discover, JCB, Master- Card, Visa) will you subscribe to?
    <p><em>Why this is important: Each payment brand has it's own validation requirements.</em></p></li>
  <li>What Self-Assessment Questionnaire will you complete?
    <p><em>Why this is important: Seek assistance from a Qualified Security Advisor (QSA) to determine which <a href="https://www.pcisecuritystandards.org/merchants/self_assessment_form.php">PCI Data Security Standard Self-Assessment</a> questionnaire fits your business processes.</em></p></li>
  <li>Are you a Service Provider, Merchant, or both?
    <p><em>Why this is important: To determine which validation requirements apply to your business.</em></p></li>
  <li>Do you have the in-house resources to drive compliance?
    <p><em>Why this is important: To identify gaps and assess where partnerships bring the most value.</em></p></li>
</ol>

<p><strong>Options available:</strong></p>

<p>The cornerstone of PCI-DSS is data protection. Your company policies and credit card transaction volume, along with other business factors not discussed here, should guide where you decide to store this data and how you protect it. Options to explore:</p>

<ul>
  <li>Store credit card data at a provider offering PCI-DSS compliant infrastructure.</li>
  <li>Store credit card information using a third-party payment gateway transmitting data server side using APIs. They collect the data and send it encrypted to your servers.
    <p><img height="103" align="center" src="https://8026b2e3760e2433679c-fffceaebb8c6ee053c935e8915a3fbe7.ssl.cf2.rackcdn.com/pci5a.png" width="499" /></p>
    <p>How it works:<br />
    <ol>
      <li>Upon the customer's request to checkout, a form is displayed to your customer to collect the required payment information. When the customer submits the form, the data is encrypted and then sent to your servers.</li>
      <li>Using a client library, a server-to-server (S2S) call to payment gateway is made to complete the processing of the transaction.</li>
      <li>The payment gateway processes the transaction and returns a response to your server.</li>
      <li>This response can be used to display relevant data to the customer in the browser, such as the status of the transaction.</li>
    </ol></p>
  </li>
  <li>Store credit card information using a third-party payment gateway transmitting data from the client browser before reaching your server.
    <p><img height="287" align="center" src="https://8026b2e3760e2433679c-fffceaebb8c6ee053c935e8915a3fbe7.ssl.cf2.rackcdn.com/pci6a.png" width="311" /></p>
    <p>How it works:<br />
    <ol>
      <li>Upon the customer's request to checkout, a form is displayed to your customer to collect the required payment information. When the customer submits the form, the data is posted directly to the payment gateway over an SSL connection.</li>
      <li>The payment gateway then stores the data. Because the payment gateway redirects the customer back to your site without displaying any content, the customer never knows that they've even left your site.</li>
      <li>The customer's browser requests the redirected URL from your site. The query string for the request URL contains a token that identifies the stored data from Step 1.</li>
      <li>Using the client library, you make a server-to-server (S2S) call to payment gateway is made to complete the processing of the request. This step confirms that if the customer doesn't complete the redirect back to your site, the payment gateway will not complete the transaction.</li>
      <li>After receiving the confirmation request, the payment gateway will run the transaction and send a response.</li>
    </ol></p>
  </li>
</ul>

<h4>Deciding between storing data in-house or using payment gateway</h4>

<p>Compare the cost of using a third-party payment gateway with the cost of storing credit card information in your data center or a provider's data center. Compare these calculations to guide your decision:</p>

<ul>
  <li>Calculate the cost of additional products/services required to store credit card data in-house per month. Rackspace can help you create sample configurations and provide estimates about cost.</li>
  <li>Calculate the cost of using a third-party payment gateway per month = number of transactions * cost of transaction charged by payment gateway + online revenue * % of revenue to be paid to payment gateway vendor.</li>
</ul>

<p>If you find storing data on-site is more expensive than the gateway, consider moving to a gateway. If using the payment gateway is more expensive or a third party gateway is incompatible with other company policies, consider storing data in a PCI-DSS compliant data center on dedicated servers.</p>

<h4>Deciding between transmitting data from the server or browser</h4>

<p>Using APIs from client browsers excludes your server infrastructure from the scope of PCI-DSS compliance as all sensitive data is transmitted between the user and the payment gateway.</p>

<p>When you choose to transmit credit card information from the server side using third party payment gateway APIs, your server infrastructure becomes part of PCI-DSS compliance since sensitive data crosses your infrastructure.</p>

<h4>PCI-DSS compliant solution for Rackspace Dedicated Hosting</h4>

<p>Example of PCI-DSS compliant reference architecture without a payment gateway:</p>

<p><img align="center" src="http://f494fe00a131971608ff-3fb62eaa3f125e9bde603735b3681623.r27.cf1.rackcdn.com/security/security-sample-architecture.png" /></p>

<p>Use the following table to align your PCI-DSS compliance needs with Rackspace services:</p>

<p><img align="center" src="https://8026b2e3760e2433679c-fffceaebb8c6ee053c935e8915a3fbe7.ssl.cf2.rackcdn.com/pci7a-chart1b.png" /></p>

<h4>PCI compliant solutions for Rackspace Cloud Hosting</h4>

<p><img align="right" height="153" src="http://images.cdn.rackspace.com/solutions/ecommerce/pci-compliance.gif" width="324" />When you host your environment with Rackspace, you may also sign up with a separate payment processor to provide tokenizationâ€”replacing credit card data with meaningless numbers or "tokens." When you accept a payment, non-PCI-DSS data routes to your Rackspace-hosted environment, while the tokenized credit card data routes to your payment processor.</p>

<p>Since your customersâ€™ credit card data does not route to your Rackspace hosted infrastructureâ€”only the payment processorâ€”your Rackspace environment stays out of the scope of your PCI-DSS requirements.</p>

<p>Check out <a href="https://cloudtools.rackspace.com/home">Rackspace Cloud Tools partners</a> for Rackspace-recommended payment gateway services:</p>

<p><a href="https://cloudtools.rackspace.com/apps/757?1197262527"><img align="left" src="http://c386932.r32.cf1.rackcdn.com/app_resources/757/thumbs_112/img1875829224899302087.png" />Stripe</a> is a simple, developer-friendly way to accept payments online. Stripe handles custom payment forms, storing cards, subscriptions, and direct payouts.<br />
Best fit for: Developers building payment applications using APIs<br />
Pricing: 2.9% + 30&cent; per successful charge<sup>*</sup><br />
<a href="https://cloudtools.rackspace.com/apps/757?1478916637">Learn More</a></p>

<p><a href="https://cloudtools.rackspace.com/apps/621?230940707"><img align="left" src="http://c386932.r32.cf1.rackcdn.com/app_resources/621/thumbs_112/img2786457282233237070.png" />Braintree</a> is a full-stack payments platform for mobile apps and websites. The service provides merchant account, payment gateway, recurring billing and credit card storage including one-touch payments to mobile SDKs and foreign currency acceptance.<br />
Best fit for: Developers building payment applications using APIs<br />
Pricing: 2.9% + 30&cent; per successful charge<sup>*</sup><br />
<a href="https://cloudtools.rackspace.com/apps/621?230940707">Learn More</a></p>

<p><a href="https://cloudtools.rackspace.com/apps/791?163191746"><img align="left" src="http://c386932.r32.cf1.rackcdn.com/app_resources/791/thumbs_112/img6350419810339149849.png" /></a>With more than 123 million active accounts in 190 markets and 25 currencies around the world, <a href="https://cloudtools.rackspace.com/apps/791?163191746">PayPal</a> enables global commerce via mobile devices and in store. Service features automatic fraud screening, Seller Protection Policy, and the BillMeLaterÂ® financing option.<br />
Best fit for: Handling international currencies<br />
Pricing: 2.9% + 30&cent; per successful charge<sup>*</sup><br />
<a href="https://cloudtools.rackspace.com/apps/791?163191746">Learn More</a></p>

<p><em><sup>*</sup>Pricing and features noted as of the writing of this paper.</em></p>

<h3>Conclusion</h3>

<p>A key step to a successful compliance program is the establishment of continuous management of the people, processes and technology. It is a common misconception for many small and large organizations that investing solely in technologies will solve their security and compliance requirements. Technologies like firewalls, Intrusion Detection Systems (IDS) and log management appliances are only as effective as the people and processes in place to install and manage them.</p>

<p>This is a lesson that Transport for London (TFL), responsible for managing transport services across Englandâ€™s capital city, learned while trying to achieve PCI-DSS compliance for its travel payment system. Their system was handling up to 40,000 visits per day with over 2.5 million registered users. Being a 24-hour business, 365 days of the year, they couldnâ€™t risk a breach or other outage disrupting operations. They turned to Rackspace for the pieces of the puzzle they needed <a href="http://www.rackspace.com/security/domains/#pci">to become fully compliant</a>. "It is probably true to say that without the considerable amount of help from Rackspace we could not have passed the exceptionally stringent PCI-DSS audit. Rackspace certainly went above and beyond their remit to ensure that everything was perfect for us," says Aingaran Somaskandarajah, Technical Lead, Oyster Card.</p>

<p>Let Rackspace be your trusted partner in the PCI-DSS journey. We can help you navigate the maze with infrastructure and solution requirements to help reduce the scope and complexity of your compliance efforts. <a href="http://www.rackspace.com/ecommerce-hosting/pci/">Contact us today to discuss your needs or explore PCI-DSS Compliance services now</a>.</p>

<p><a href="http://www.rackspace.com/ecommerce-hosting/"><img align="center" src="https://8026b2e3760e2433679c-fffceaebb8c6ee053c935e8915a3fbe7.ssl.cf2.rackcdn.com/pci8a.png" /></a></p>

<p><strong>References:</strong></p>

<p><sup>1</sup> <a href="http://www.verizonenterprise.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf%20">http://www.verizonenterprise.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf </a><br />
<sup>2</sup> <a href="http://www.verizonenterprise.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf%20">http://www.verizonenterprise.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf </a><br />
<sup>3</sup> <a href="http://www.verizonenterprise.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf%20">http://www.verizonenterprise.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf </a><br />
<sup>4</sup> <a href="https://www.pcisecuritystandards.org/merchants/self_assessment_form.php">https://www.pcisecuritystandards.org/merchants/self_assessment_form.php</a><br />
<sup>5</sup> <a href="https://www.pcisecuritystandards.org/merchants/self_assessment_form.php">https://www.pcisecuritystandards.org/merchants/self_assessment_form.php</a><br />
<sup>6</sup> <a href="http://www.verizonenterprise.com/DBIR/2013/">http://www.verizonenterprise.com/DBIR/2013/</a></p>
